import{i as e,u as s}from"./q-c0df5510.js";const o=[{text:"Events",id:"events",level:1},{text:"Prevent default",id:"prevent-default",level:2},{text:"Window and Document events",id:"window-and-document-events",level:2},{text:"Events and Components",id:"events-and-components",level:2},{text:"Working with QRLs",id:"working-with-qrls",level:2},{text:"State recovery",id:"state-recovery",level:2},{text:"Qwikloader",id:"qwikloader",level:2}],l={title:"Events",meta:[],styles:[],links:[]},i={title:"Events"};function t(a){const n=Object.assign({h1:"h1",a:"a",span:"span",p:"p",pre:"pre",code:"code",h2:"h2",ol:"ol",li:"li"},a.components);return e(s,{children:[e(n.h1,{id:"events",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#events",children:e(n.span,{className:"icon icon-link"})}),"Events"]}),`
`,e(n.p,{children:"For a web application to be interactive, there needs to be a way to respond to user events. This is done by registering callback functions in the JSX template."}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"const"})," Counter ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," store ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"useStore"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"{"})," count",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," store",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token operator",children:"++"}),e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.p,{children:["In the above example, the ",e(n.code,{children:"onClick$"})," attribute of the ",e(n.code,{children:"<button>"})," element is used to let Qwik know that a callback ",e(n.code,{children:"() => store.count++"})," should be executed whenever the ",e(n.code,{children:"click"})," event is fired by the ",e(n.code,{children:"<button>"}),"."]}),`
`,e(n.p,{children:["Notice that ",e(n.code,{children:"onClick$"})," ends with ",e(n.code,{children:"$"}),". This is a hint to both the Qwik Optimizer and the developer that a special transformation occurs at this location. The presence of the ",e(n.code,{children:"$"})," suffix implies a lazy-loaded boundary here. The code associated with the ",e(n.code,{children:"click"})," handler will not download until the user triggers the ",e(n.code,{children:"click"})," event. See ",e(n.a,{href:"/docs/advanced/optimizer/",children:"Optimizer Rules"})," for more details."]}),`
`,e(n.p,{children:["In the above example, the ",e(n.code,{children:"click"})," listener is trivial in implementation. But in real applications, the listener may refer to complex code. By creating a lazy-loaded boundary, Qwik can tree-shake all of the code behind the click listener and delay its loading until the user clicks the button."]}),`
`,e(n.p,{children:"You can also pass QRLs as values for event listeners. For instance, the above example could also be written in the following way:"}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"import"})," ",e(n.span,{className:"token punctuation",children:"{"})," component$",e(n.span,{className:"token punctuation",children:","})," useStore",e(n.span,{className:"token punctuation",children:","})," $ ",e(n.span,{className:"token punctuation",children:"}"})," ",e(n.span,{className:"token keyword",children:"from"})," ",e(n.span,{className:"token string",children:'"@builder.io/qwik"'}),e(n.span,{className:"token punctuation",children:";"}),`

`,e(n.span,{className:"token keyword",children:"const"})," Counter ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," store ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"useStore"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"{"})," count",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," incrementCount ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," store",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token operator",children:"++"}),e(n.span,{className:"token punctuation",children:")"}),`

  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),"incrementCount",e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.h2,{id:"prevent-default",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#prevent-default",children:e(n.span,{className:"icon icon-link"})}),"Prevent default"]}),`
`,e(n.p,{children:["Because of the async nature of Qwik, an event's handler execution might be delayed because the implementation has not been downloaded yet. This introduces a problem when the event's handler needs to prevent the default behavior of the event. Traditional ",e(n.code,{children:"event.preventDefault()"})," will not work, so instead use Qwik's ",e(n.code,{children:"preventdefault:{eventName}"})," attribute:"]}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"const"})," PreventDefaultExample ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token punctuation",children:"("}),`
    `,e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"a"]}),`
      `,e(n.span,{className:"token attr-name",children:"href"}),e(n.span,{className:"token attr-value",children:[e(n.span,{className:"token punctuation attr-equals",children:"="}),e(n.span,{className:"token punctuation",children:'"'}),"/about",e(n.span,{className:"token punctuation",children:'"'})]}),`
      `,e(n.span,{className:"token attr-name",children:[e(n.span,{className:"token namespace",children:"preventdefault:"}),"click"]})," ",e(n.span,{className:"token comment",children:'// This will prevent the default behavior of the "click" event.'}),`
      `,e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),"event",e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
        `,e(n.span,{className:"token comment",children:"// PreventDefault will not work here, because handle is dispatched asynchronously."}),`
        `,e(n.span,{className:"token comment",children:"// event.preventDefault();"}),`
        `,e(n.span,{className:"token function",children:"singlePageNavigate"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token string",children:"'/about'"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
      `,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:"}"})]}),`
    `,e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      Go to about page
    `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"a"]}),e(n.span,{className:"token punctuation",children:">"})]}),`
  `,e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.h2,{id:"window-and-document-events",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#window-and-document-events",children:e(n.span,{className:"icon icon-link"})}),"Window and Document events"]}),`
`,e(n.p,{children:["So far, we have discussed how to listen to events that originate from elements. There are events (for example, ",e(n.code,{children:"scroll"})," and ",e(n.code,{children:"mousemove"}),") that require that we listen to them on the ",e(n.code,{children:"window"})," or ",e(n.code,{children:"document"}),". For this reason, Qwik allows for the ",e(n.code,{children:"document:on"})," and ",e(n.code,{children:"window:on"})," prefixes when listening for events."]}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"const"})," EventExample ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," store ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"useStore"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"{"}),`
    scroll`,e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"}),e(n.span,{className:"token punctuation",children:","}),`
    mouse`,e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token punctuation",children:"{"})," x",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"}),e(n.span,{className:"token punctuation",children:","})," y",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:","}),`
    clickCount`,e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"}),e(n.span,{className:"token punctuation",children:","}),`
  `,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token punctuation",children:"("}),`
    `,e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]}),`
      `,e(n.span,{className:"token attr-name",children:[e(n.span,{className:"token namespace",children:"window:"}),"onScroll$"]}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),"e",e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"("}),"store",e(n.span,{className:"token punctuation",children:"."}),"scroll ",e(n.span,{className:"token operator",children:"="})," window",e(n.span,{className:"token punctuation",children:"."}),"scrollY",e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:"}"})]}),`
      `,e(n.span,{className:"token attr-name",children:[e(n.span,{className:"token namespace",children:"document:"}),"onMouseMove$"]}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),"e",e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
        store`,e(n.span,{className:"token punctuation",children:"."}),"mouse",e(n.span,{className:"token punctuation",children:"."}),"x ",e(n.span,{className:"token operator",children:"="})," e",e(n.span,{className:"token punctuation",children:"."}),"x",e(n.span,{className:"token punctuation",children:";"}),`
        store`,e(n.span,{className:"token punctuation",children:"."}),"mouse",e(n.span,{className:"token punctuation",children:"."}),"y ",e(n.span,{className:"token operator",children:"="})," e",e(n.span,{className:"token punctuation",children:"."}),"y",e(n.span,{className:"token punctuation",children:";"}),`
      `,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:"}"})]}),`
      `,e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," store",e(n.span,{className:"token punctuation",children:"."}),"clickCount",e(n.span,{className:"token operator",children:"++"}),e(n.span,{className:"token punctuation",children:"}"})]}),`
    `,e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      scroll: `}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"scroll",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token plain-text",children:`
      mouseMove: `}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"mouse",e(n.span,{className:"token punctuation",children:"."}),"x",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token plain-text",children:", "}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"mouse",e(n.span,{className:"token punctuation",children:"."}),"y",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token plain-text",children:`
      click: `}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"clickCount",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token plain-text",children:`
    `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),`
  `,e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.p,{children:["The purpose of the ",e(n.code,{children:"window:on"}),"/",e(n.code,{children:"document:"})," is to register an event at a current DOM location of the component but have it receive events from the ",e(n.code,{children:"window"}),"/",e(n.code,{children:"document"}),". There are two advantages to this:"]}),`
`,e(n.ol,{children:[`
`,e(n.li,{children:"The events can be registered declaratively in your JSX"}),`
`,e(n.li,{children:"The events get automatically cleaned up when the component is destroyed. (No explicit bookkeeping and cleanup is needed)"}),`
`]}),`
`,e(n.h2,{id:"events-and-components",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#events-and-components",children:e(n.span,{className:"icon icon-link"})}),"Events and Components"]}),`
`,e(n.p,{children:"Components are functions, not elements. Since DOM events do not exist naturally, it's possible to define custom events as props."}),`
`,e(n.p,{children:"Now let's look at how one declares a child component that can be used with events."}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"import"})," ",e(n.span,{className:"token punctuation",children:"{"})," PropFunction ",e(n.span,{className:"token punctuation",children:"}"})," ",e(n.span,{className:"token keyword",children:"from"})," ",e(n.span,{className:"token string",children:"'@builder.io/qwik'"}),e(n.span,{className:"token punctuation",children:";"}),`

`,e(n.span,{className:"token keyword",children:"interface"})," ",e(n.span,{className:"token class-name",children:"CmpButtonProps"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  onClick$`,e(n.span,{className:"token operator",children:"?"}),e(n.span,{className:"token operator",children:":"})," PropFunction",e(n.span,{className:"token operator",children:"<"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token keyword",children:"void"}),e(n.span,{className:"token operator",children:">"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),`

`,e(n.span,{className:"token keyword",children:"const"})," CmpButton ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),"props",e(n.span,{className:"token operator",children:":"})," CmpButtonProps",e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token punctuation",children:"("}),`
    `,e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:"onDblclick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),"props",e(n.span,{className:"token punctuation",children:"."}),"onClick$",e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),e(n.span,{className:"token class-name",children:"Slot"})]})," ",e(n.span,{className:"token punctuation",children:"/>"})]}),e(n.span,{className:"token plain-text",children:`
    `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),`
  `,e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.p,{children:["As far as Qwik is concerned, passing events to a component is equivalent to passing as props. In our example, we declare all props in ",e(n.code,{children:"CmpButtonProps"})," interface. Specifically, notice ",e(n.code,{children:"onClick$: PropFunction<() => void>"})," declaration."]}),`
`,e(n.p,{children:["On the usage side, when referring to the ",e(n.code,{children:"<CmpButton>"}),":"]}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),e(n.span,{className:"token class-name",children:"CmpButton"})]})," ",e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," store",e(n.span,{className:"token punctuation",children:"."}),"cmpCount",e(n.span,{className:"token operator",children:"++"}),e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"cmpCount",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),e(n.span,{className:"token class-name",children:"CmpButton"})]}),e(n.span,{className:"token punctuation",children:">"})]}),`
`]})}),`
`,e(n.h2,{id:"working-with-qrls",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#working-with-qrls",children:e(n.span,{className:"icon icon-link"})}),"Working with QRLs"]}),`
`,e(n.p,{children:["Let's look at a variation of the above ",e(n.code,{children:"<CmpButton>"})," implementation. In this example, we would like to demonstrate the passing of callbacks to components. For this reason, we have created an additional listener ",e(n.code,{children:"onClick$"})]}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"interface"})," ",e(n.span,{className:"token class-name",children:"CmpButtonProps"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  onClick$`,e(n.span,{className:"token operator",children:"?"}),e(n.span,{className:"token operator",children:":"})," PropFunction",e(n.span,{className:"token operator",children:"<"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token builtin",children:"number"}),e(n.span,{className:"token operator",children:">"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),`

`,e(n.span,{className:"token keyword",children:"const"})," CmpButton ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),"props",e(n.span,{className:"token operator",children:":"})," CmpButtonProps",e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token punctuation",children:"("}),`
    `,e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]}),`
      `,e(n.span,{className:"token attr-name",children:"onDblclick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),"props",e(n.span,{className:"token punctuation",children:"."}),"onClick$",e(n.span,{className:"token punctuation",children:"}"})]}),`
      `,e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token keyword",children:"async"})," ",e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
        `,e(n.span,{className:"token keyword",children:"const"})," nu ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token keyword",children:"await"})," props",e(n.span,{className:"token operator",children:"?."}),e(n.span,{className:"token function",children:"onClick$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
        `,e(n.span,{className:"token builtin",children:"console"}),e(n.span,{className:"token punctuation",children:"."}),e(n.span,{className:"token function",children:"log"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token string",children:"'clicked'"}),e(n.span,{className:"token punctuation",children:","})," nu",e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
      `,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:"}"})]}),`
    `,e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),e(n.span,{className:"token class-name",children:"Slot"})]})," ",e(n.span,{className:"token punctuation",children:"/>"})]}),e(n.span,{className:"token plain-text",children:`
    `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),`
  `,e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.p,{children:["Notice that we can pass the ",e(n.code,{children:"props.onClick$"})," method directly to the ",e(n.code,{children:"onDblclick$"})," attribute as seen on ",e(n.code,{children:"<button>"})," element. (see attribute ",e(n.code,{children:"onDblclick$={props.onClick$}"}),") This is because both the inputting prop ",e(n.code,{children:"onClick$"})," as well as JSX prop ",e(n.code,{children:"onDblclick"})," are of type ",e(n.code,{children:"PropFunction<?>"})," (and both have ",e(n.code,{children:"$"})," suffix)."]}),`
`,e(n.p,{children:["However, it is not possible to pass ",e(n.code,{children:"props.onClick$"})," to ",e(n.code,{children:"onClick$"})," because the types don't match. (This would result in the type error: ",e(n.code,{children:"onClick$={props.onClick$}"}),") Instead, the ",e(n.code,{children:"$"})," is reserved for inlined closures. In our example, we would like to ",e(n.code,{children:'console.log("clicked")'})," after we process the ",e(n.code,{children:"props.onClick"})," callback. We can do so with the ",e(n.code,{children:"props.onClick$()"})," method. This method will:"]}),`
`,e(n.ol,{children:[`
`,e(n.li,{children:"Lazy load the code"}),`
`,e(n.li,{children:"Restore the closure state"}),`
`,e(n.li,{children:"Invoke the closure"}),`
`]}),`
`,e(n.p,{children:["The operation is asynchronous and therefore returns a promise, which we can resolve using the ",e(n.code,{children:"await"})," statement."]}),`
`,e(n.h2,{id:"state-recovery",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#state-recovery",children:e(n.span,{className:"icon icon-link"})}),"State recovery"]}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"const"})," Counter ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," store ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"useStore"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"{"})," count",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," store",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token operator",children:"++"}),e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.p,{children:["At first sight, it may appear that Qwik simply lazy loads the ",e(n.code,{children:"onClick$"})," function. But upon closer inspection, it is important to realize that Qwik lazy loads a closure rather than a function. (A closure is a function that lexically captures the state inside its variables. In other words, closures carry state, whereas functions do not.) The capturing of the state is what allows the Qwik application to simply resume where the server left off because the recovered closure carries the state of the application with it."]}),`
`,e(n.p,{children:["In our case, the ",e(n.code,{children:"onClick$"})," closure captures ",e(n.code,{children:"store"}),". The capturing of ",e(n.code,{children:"store"})," allows the application to increment the ",e(n.code,{children:"count"})," property on ",e(n.code,{children:"click"})," without having to re-run the whole application. Let's look at how closure capturing works in Qwik."]}),`
`,e(n.p,{children:"The HTML generated by the above code would look something like this:"}),`
`,e(n.pre,{children:e(n.code,{className:"language-html",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"div"]}),e(n.span,{className:"token punctuation",children:">"})]}),`
  `,e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:[e(n.span,{className:"token namespace",children:"q:"}),"obj"]}),e(n.span,{className:"token attr-value",children:[e(n.span,{className:"token punctuation attr-equals",children:"="}),e(n.span,{className:"token punctuation",children:'"'}),"1",e(n.span,{className:"token punctuation",children:'"'})]})," ",e(n.span,{className:"token attr-name",children:[e(n.span,{className:"token namespace",children:"on:"}),"click"]}),e(n.span,{className:"token attr-value",children:[e(n.span,{className:"token punctuation attr-equals",children:"="}),e(n.span,{className:"token punctuation",children:'"'}),"./chunk-a.js#Counter_button_onClick[0]",e(n.span,{className:"token punctuation",children:'"'})]}),e(n.span,{className:"token punctuation",children:">"})]}),"0",e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),`
`,e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"div"]}),e(n.span,{className:"token punctuation",children:">"})]}),`
`]})}),`
`,e(n.p,{children:["Notice that ",e(n.code,{children:"on:click"})," attribute contains three pieces of information:"]}),`
`,e(n.ol,{children:[`
`,e(n.li,{children:[e(n.code,{children:"./chunk-a.js"}),": The file which needs to be lazy-loaded."]}),`
`,e(n.li,{children:[e(n.code,{children:"Counter_button_onClick"}),": The symbol which needs to be retrieved from the lazy-loaded chunk."]}),`
`,e(n.li,{children:[e(n.code,{children:"[0]"}),": An array of lexically captured variable references (State of the closure)."]}),`
`]}),`
`,e(n.p,{children:["In our case ",e(n.code,{children:"() => store.count++"})," only captures ",e(n.code,{children:"store"}),", and hence it contains only a single reference ",e(n.code,{children:"0"}),". ",e(n.code,{children:"0"})," is an index into the ",e(n.code,{children:"q:obj"})," attribute that contains a reference to the actual serialized object, referring to ",e(n.code,{children:"store"}),". (The exact mechanisms and syntax is an implementation detail that can change at any time)"]}),`
`,e(n.h2,{id:"qwikloader",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#qwikloader",children:e(n.span,{className:"icon icon-link"})}),"Qwikloader"]}),`
`,e(n.p,{children:["For the browser to understand the ",e(n.code,{children:"on:click"}),` attribute syntax, a small JavaScript script known as the Qwikloader is needed. The Qwikloader is small (about 1kb) and fast (about 5ms) in execution. The Qwikloader script is inlined into the HTML so that it can be executed quickly.
When a user interacts with the application, the browser fires relevant events that bubble up the DOM. At the root of the DOM, the Qwikloader listens for the events and then tries to locate the corresponding `,e(n.code,{children:"on:<event>"})," attribute. If such an attribute is found, then the value of the attribute is used to resolve the location where code can be downloaded from and then executes it."]}),`
`,e(n.p,{children:["See ",e(n.a,{href:"/docs/advanced/qwikloader/",children:"Qwikloader"})," for more details."]})]})}function r(a={}){const{wrapper:n}=a.components||{};return n?e(n,Object.assign({},a,{children:e(t,a)})):t(a)}export{r as default,i as frontmatter,l as head,o as headings};
