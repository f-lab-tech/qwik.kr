import{i as n,u as s}from"./q-c0df5510.js";const o=[{text:"Fetching data",id:"fetching-data",level:2},{text:"Rendering data",id:"rendering-data",level:2},{text:"SSR vs Client",id:"ssr-vs-client",level:2}],i={title:"useResource$()",meta:[],styles:[],links:[]},r={title:"useResource$()"};function t(a){const e=Object.assign({p:"p",code:"code",ul:"ul",li:"li",h2:"h2",a:"a",span:"span",pre:"pre"},a.components);return n(s,{children:[n(e.p,{children:["For this tutorial, we would like to fetch the list of repositories for a given GitHub organization. To aid you, we have added the ",n(e.code,{children:"getRepositories()"})," function to the bottom of the file. Your task is to use the ",n(e.code,{children:"getRepositories()"})," function to fetch the list of repositories whenever the user updates the ",n(e.code,{children:"org"})," input."]}),`
`,n(e.p,{children:["Qwik provides ",n(e.code,{children:"useResource$()"})," and ",n(e.code,{children:"<Resource>"})," to help you fetch and display data from the server. When fetching data the application can be in one of three states:"]}),`
`,n(e.ul,{children:[`
`,n(e.li,{children:[n(e.code,{children:"pending"}),": the data is being fetched from the server => Render ",n(e.code,{children:"loading..."})," indicator."]}),`
`,n(e.li,{children:[n(e.code,{children:"resolved"}),": the data has successfully been fetched from the server => Render the data."]}),`
`,n(e.li,{children:[n(e.code,{children:"rejected"}),": the data could not be fetched from the server due to an error => Render the error."]}),`
`]}),`
`,n(e.p,{children:["Use ",n(e.code,{children:"useResource$()"})," function to set up how the data is fetched from the server. Use ",n(e.code,{children:"<Resource>"})," to display the data."]}),`
`,n(e.h2,{id:"fetching-data",children:[n(e.a,{"aria-hidden":"true",tabIndex:"-1",href:"#fetching-data",children:n(e.span,{className:"icon icon-link"})}),"Fetching data"]}),`
`,n(e.p,{children:["Use ",n(e.code,{children:"useResource$()"})," to set up how the data is fetched from the server."]}),`
`,n(e.pre,{children:n(e.code,{className:"language-jsx",children:["  ",n(e.span,{className:"token keyword",children:"const"})," reposResource ",n(e.span,{className:"token operator",children:"="})," useResource$",n(e.span,{className:"token operator",children:"<"}),"string",n(e.span,{className:"token punctuation",children:"["}),n(e.span,{className:"token punctuation",children:"]"}),n(e.span,{className:"token operator",children:">"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token parameter",children:[n(e.span,{className:"token punctuation",children:"{"})," track",n(e.span,{className:"token punctuation",children:","})," cleanup ",n(e.span,{className:"token punctuation",children:"}"})]}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token punctuation",children:"{"}),`
    `,n(e.span,{className:"token comment",children:"// We need a way to re-run fetching data whenever the `github.org` changes."}),`
    `,n(e.span,{className:"token comment",children:"// Use `track` to trigger re-running of this data fetching function."}),`
    `,n(e.span,{className:"token function",children:"track"}),n(e.span,{className:"token punctuation",children:"("}),"github",n(e.span,{className:"token punctuation",children:","})," ",n(e.span,{className:"token string",children:"'org'"}),n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`

    `,n(e.span,{className:"token comment",children:"// A good practice is to use `AbortController` to abort the fetching of data if"}),`
    `,n(e.span,{className:"token comment",children:"// new request comes in. We create a new `AbortController` and register a `cleanup`"}),`
    `,n(e.span,{className:"token comment",children:"// function which is called when this function re-runs."}),`
    `,n(e.span,{className:"token keyword",children:"const"})," controller ",n(e.span,{className:"token operator",children:"="})," ",n(e.span,{className:"token keyword",children:"new"})," ",n(e.span,{className:"token class-name",children:"AbortController"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`
    `,n(e.span,{className:"token function",children:"cleanup"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," controller",n(e.span,{className:"token punctuation",children:"."}),n(e.span,{className:"token function",children:"abort"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`

    `,n(e.span,{className:"token comment",children:"// Fetch the data and return the promises."}),`
    `,n(e.span,{className:"token keyword",children:"return"})," ",n(e.span,{className:"token function",children:"getRepositories"}),n(e.span,{className:"token punctuation",children:"("}),"github",n(e.span,{className:"token punctuation",children:"."}),"org",n(e.span,{className:"token punctuation",children:","})," controller",n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`
  `,n(e.span,{className:"token punctuation",children:"}"}),n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,n(e.p,{children:["The ",n(e.code,{children:"useResource$()"})," function returns a ",n(e.code,{children:"ResourceReturn"})," object, which is a Promise-like object that can be serialized by Qwik. The ",n(e.code,{children:"useResource$()"})," function allows you to ",n(e.code,{children:"track"})," store properties so that the ",n(e.code,{children:"useResource$()"})," function can be reactive on store changes. The ",n(e.code,{children:"cleanup"})," function allows you to register a code that needs to be run to release resources from the previous run. Finally, the ",n(e.code,{children:"useResource$()"})," function returns a promise that will resolve to the value."]}),`
`,n(e.h2,{id:"rendering-data",children:[n(e.a,{"aria-hidden":"true",tabIndex:"-1",href:"#rendering-data",children:n(e.span,{className:"icon icon-link"})}),"Rendering data"]}),`
`,n(e.p,{children:["Use ",n(e.code,{children:"<Resource>"})," to display the data of the ",n(e.code,{children:"useResource$()"})," function. The ",n(e.code,{children:"<Resource>"})," allows you to render different content depending if the resource is ",n(e.code,{children:"pending"}),", ",n(e.code,{children:"resolved"})," or ",n(e.code,{children:"rejected"}),"."]}),`
`,n(e.p,{children:["On the server the ",n(e.code,{children:"<Resource>"})," does not render ",n(e.code,{children:"loading"})," state, instead, it pauses rendering until the resource is resolved and will always render as either ",n(e.code,{children:"resolved"})," or ",n(e.code,{children:"rejected"}),". (On the client, the ",n(e.code,{children:"<Resource>"})," renders all states including ",n(e.code,{children:"pending"}),".)"]}),`
`,n(e.pre,{children:n(e.code,{className:"language-jsx",children:["  ",n(e.span,{className:"token tag",children:[n(e.span,{className:"token tag",children:[n(e.span,{className:"token punctuation",children:"<"}),n(e.span,{className:"token class-name",children:"Resource"})]}),`
     `,n(e.span,{className:"token attr-name",children:"value"}),n(e.span,{className:"token script language-javascript",children:[n(e.span,{className:"token script-punctuation punctuation",children:"="}),n(e.span,{className:"token punctuation",children:"{"}),"resourceToRender",n(e.span,{className:"token punctuation",children:"}"})]}),n(e.span,{className:"token punctuation",children:">"})]}),n(e.span,{className:"token plain-text",children:`
     onPending=`}),n(e.span,{className:"token punctuation",children:"{"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token tag",children:[n(e.span,{className:"token tag",children:[n(e.span,{className:"token punctuation",children:"<"}),"div"]}),n(e.span,{className:"token punctuation",children:">"})]}),n(e.span,{className:"token plain-text",children:"Loading..."}),n(e.span,{className:"token tag",children:[n(e.span,{className:"token tag",children:[n(e.span,{className:"token punctuation",children:"</"}),"div"]}),n(e.span,{className:"token punctuation",children:">"})]}),n(e.span,{className:"token punctuation",children:"}"}),n(e.span,{className:"token plain-text",children:`
     onError=`}),n(e.span,{className:"token punctuation",children:"{"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token parameter",children:"reason"}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token tag",children:[n(e.span,{className:"token tag",children:[n(e.span,{className:"token punctuation",children:"<"}),"div"]}),n(e.span,{className:"token punctuation",children:">"})]}),n(e.span,{className:"token plain-text",children:"Error: "}),n(e.span,{className:"token punctuation",children:"{"}),"reason",n(e.span,{className:"token punctuation",children:"}"}),n(e.span,{className:"token tag",children:[n(e.span,{className:"token tag",children:[n(e.span,{className:"token punctuation",children:"</"}),"div"]}),n(e.span,{className:"token punctuation",children:">"})]}),n(e.span,{className:"token punctuation",children:"}"}),n(e.span,{className:"token plain-text",children:`
     onResolved=`}),n(e.span,{className:"token punctuation",children:"{"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token parameter",children:"data"}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token tag",children:[n(e.span,{className:"token tag",children:[n(e.span,{className:"token punctuation",children:"<"}),"div"]}),n(e.span,{className:"token punctuation",children:">"})]}),n(e.span,{className:"token punctuation",children:"{"}),"data",n(e.span,{className:"token punctuation",children:"}"}),n(e.span,{className:"token tag",children:[n(e.span,{className:"token tag",children:[n(e.span,{className:"token punctuation",children:"</"}),"div"]}),n(e.span,{className:"token punctuation",children:">"})]}),n(e.span,{className:"token punctuation",children:"}"}),n(e.span,{className:"token plain-text",children:`
  />
`})]})}),`
`,n(e.h2,{id:"ssr-vs-client",children:[n(e.a,{"aria-hidden":"true",tabIndex:"-1",href:"#ssr-vs-client",children:n(e.span,{className:"icon icon-link"})}),"SSR vs Client"]}),`
`,n(e.p,{children:["Notice that the same code can render on both server and client (with slightly different behavior, which skips the ",n(e.code,{children:"pending"})," state rendering on the server.)"]})]})}function l(a={}){const{wrapper:e}=a.components||{};return e?n(e,Object.assign({},a,{children:n(t,a)})):t(a)}export{l as default,r as frontmatter,i as head,o as headings};
