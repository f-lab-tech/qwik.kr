import{i as n,u as t}from"./q-c0df5510.js";const o=[{text:"Creating your APIs with $ suffix",id:"creating-your-apis-with--suffix",level:2},{text:"Example",id:"example",level:3}],l={title:"Creating APIs with $",meta:[],styles:[],links:[]},i={title:"Creating APIs with $"};function s(a){const e=Object.assign({p:"p",code:"code",pre:"pre",span:"span",h2:"h2",a:"a",blockquote:"blockquote",strong:"strong",h3:"h3"},a.components);return n(t,{children:[n(e.p,{children:["The powerful, part of Optimizer is that you can create your own APIs with ",n(e.code,{children:"$"})," suffix."]}),`
`,n(e.p,{children:"Imagine that we would like to have a delay method that lazy loads its callback. Normally we would have to write something like this:"}),`
`,n(e.pre,{children:n(e.code,{className:"language-typescript",children:[n(e.span,{className:"token function",children:"setTimeout"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token punctuation",children:"{"}),`
  `,n(e.span,{className:"token comment",children:"// I am eagerly loaded, but it would be better if I was lazy-loaded."}),`
  `,n(e.span,{className:"token operator",children:"..."}),`
`,n(e.span,{className:"token punctuation",children:"}"}),n(e.span,{className:"token punctuation",children:","})," timeout",n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,n(e.p,{children:"The issue with the example above is that the callback has to be downloaded and created eagerly. This may be an issue if the closure is large or if the callback is never executed (or only executed later.)"}),`
`,n(e.p,{children:["A better solution would be to have ",n(e.code,{children:"delay$"})," method that can lazy-load the closure associated with the callback. Something like this."]}),`
`,n(e.pre,{children:n(e.code,{className:"language-typescript",children:[n(e.span,{className:"token function",children:"delay$"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token punctuation",children:"{"}),`
  `,n(e.span,{className:"token comment",children:"// I am lazy-loaded only when I need to be executed."}),`
  `,n(e.span,{className:"token operator",children:"..."}),`
`,n(e.span,{className:"token punctuation",children:"}"}),n(e.span,{className:"token punctuation",children:","})," ",n(e.span,{className:"token number",children:"1000"}),n(e.span,{className:"token punctuation",children:")"}),`
`]})}),`
`,n(e.p,{children:["In the above solution, the callback is only downloaded when ",n(e.code,{children:"delay$"})," is ready to execute it."]}),`
`,n(e.h2,{id:"creating-your-apis-with--suffix",children:[n(e.a,{"aria-hidden":"true",tabIndex:"-1",href:"#creating-your-apis-with--suffix",children:n(e.span,{className:"icon icon-link"})}),"Creating your APIs with ",n(e.code,{children:"$"})," suffix"]}),`
`,n(e.p,{children:["Qwik runtime works with ",n(e.code,{children:"QRL"}),"s. For this reason we define a method like so:"]}),`
`,n(e.pre,{children:n(e.code,{className:"language-typescript",children:[n(e.span,{className:"token keyword",children:"export"})," ",n(e.span,{className:"token keyword",children:"function"})," ",n(e.span,{className:"token generic-function",children:[n(e.span,{className:"token function",children:"delayQrl"}),n(e.span,{className:"token generic class-name",children:[n(e.span,{className:"token operator",children:"<"}),n(e.span,{className:"token constant",children:"T"}),n(e.span,{className:"token operator",children:">"})]})]}),n(e.span,{className:"token punctuation",children:"("}),"fn",n(e.span,{className:"token operator",children:":"})," ",n(e.span,{className:"token constant",children:"QRL"}),n(e.span,{className:"token operator",children:"<"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token constant",children:"T"}),n(e.span,{className:"token operator",children:">"}),n(e.span,{className:"token punctuation",children:","})," delayInMs",n(e.span,{className:"token operator",children:":"})," ",n(e.span,{className:"token builtin",children:"number"}),n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token operator",children:":"})," ",n(e.span,{className:"token builtin",children:"Promise"}),n(e.span,{className:"token operator",children:"<"}),n(e.span,{className:"token constant",children:"T"}),n(e.span,{className:"token operator",children:">"})," ",n(e.span,{className:"token punctuation",children:"{"}),`
  `,n(e.span,{className:"token keyword",children:"return"})," ",n(e.span,{className:"token keyword",children:"new"})," ",n(e.span,{className:"token class-name",children:n(e.span,{className:"token builtin",children:"Promise"})}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:"("}),"res",n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token punctuation",children:"{"}),`
    `,n(e.span,{className:"token function",children:"setTimeout"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token punctuation",children:"{"}),`
      `,n(e.span,{className:"token function",children:"res"}),n(e.span,{className:"token punctuation",children:"("}),"fn",n(e.span,{className:"token punctuation",children:"."}),n(e.span,{className:"token function",children:"invoke"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`
    `,n(e.span,{className:"token punctuation",children:"}"}),n(e.span,{className:"token punctuation",children:","})," delayInMs",n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`
  `,n(e.span,{className:"token punctuation",children:"}"}),n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`
`,n(e.span,{className:"token punctuation",children:"}"}),`
`]})}),`
`,n(e.p,{children:["This method knows how to take a ",n(e.code,{children:"QRL"})," and execute it after a certain delay. The key part here is that the ",n(e.code,{children:"QRL.invoke()"})," method is called when the delay is ready and is therefore lazy."]}),`
`,n(e.p,{children:["The next step is to convert the ",n(e.code,{children:"delayQrl"})," method to a ",n(e.code,{children:"delay$"})," alias. This is done with ",n(e.code,{children:"implicit$FirstArg"})," like so:"]}),`
`,n(e.pre,{children:n(e.code,{className:"language-typescript",children:[n(e.span,{className:"token keyword",children:"export"})," ",n(e.span,{className:"token keyword",children:"const"})," delay$ ",n(e.span,{className:"token operator",children:"="})," ",n(e.span,{className:"token function",children:"implicit$FirstArg"}),n(e.span,{className:"token punctuation",children:"("}),"delayQrl",n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,n(e.p,{children:"Here are the types to make it clearer as to what is going on."}),`
`,n(e.pre,{children:n(e.code,{className:"language-typescript",children:[n(e.span,{className:"token keyword",children:"declare"}),n(e.span,{className:"token punctuation",children:";"}),`
`,n(e.span,{className:"token function-variable function",children:"delayQrl"}),n(e.span,{className:"token operator",children:":"})," ",n(e.span,{className:"token punctuation",children:"("}),"fn",n(e.span,{className:"token operator",children:":"})," ",n(e.span,{className:"token constant",children:"QRL"}),n(e.span,{className:"token operator",children:"<"}),n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token constant",children:"T"}),n(e.span,{className:"token operator",children:">"}),n(e.span,{className:"token punctuation",children:","})," delayInMs",n(e.span,{className:"token operator",children:":"})," ",n(e.span,{className:"token builtin",children:"number"}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token builtin",children:"Promise"}),n(e.span,{className:"token operator",children:"<"}),n(e.span,{className:"token constant",children:"T"}),n(e.span,{className:"token operator",children:">"}),n(e.span,{className:"token punctuation",children:";"}),`
`,n(e.span,{className:"token keyword",children:"declare"}),n(e.span,{className:"token punctuation",children:";"}),`
`,n(e.span,{className:"token function-variable function",children:"delay$"}),n(e.span,{className:"token operator",children:":"})," ",n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token function-variable function",children:"fn"}),n(e.span,{className:"token operator",children:":"})," ",n(e.span,{className:"token punctuation",children:"("}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token constant",children:"T"}),n(e.span,{className:"token punctuation",children:","})," delayInMs",n(e.span,{className:"token operator",children:":"})," ",n(e.span,{className:"token builtin",children:"number"}),n(e.span,{className:"token punctuation",children:")"})," ",n(e.span,{className:"token operator",children:"=>"})," ",n(e.span,{className:"token builtin",children:"Promise"}),n(e.span,{className:"token operator",children:"<"}),n(e.span,{className:"token constant",children:"T"}),n(e.span,{className:"token operator",children:">"}),n(e.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,n(e.p,{children:["The above allows us to use ",n(e.code,{children:"delay$"})," in an inlined fashion, but the Optimizer converts the ",n(e.code,{children:"delay$"})," to ",n(e.code,{children:"delayQrl"})," form."]}),`
`,n(e.blockquote,{children:[`
`,n(e.p,{children:[n(e.strong,{children:"NOTE"})," the two methods must have the same prefix. So a general form is:"]}),`
`]}),`
`,n(e.pre,{children:n(e.code,{className:"language-typescript",children:[n(e.span,{className:"token keyword",children:"export"})," ",n(e.span,{className:"token keyword",children:"const"})," SOME_NAME_Qrl ",n(e.span,{className:"token operator",children:"="})," ",n(e.span,{className:"token operator",children:"..."}),n(e.span,{className:"token punctuation",children:";"}),`
`,n(e.span,{className:"token keyword",children:"export"})," ",n(e.span,{className:"token keyword",children:"const"})," ",n(e.span,{className:"token constant",children:"SOME_NAME_"}),"$ ",n(e.span,{className:"token operator",children:"="})," ",n(e.span,{className:"token function",children:"implicit$FirstArg"}),n(e.span,{className:"token punctuation",children:"("}),"SOME_NAME_Qrl",n(e.span,{className:"token punctuation",children:")"}),n(e.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,n(e.h3,{id:"example",children:[n(e.a,{"aria-hidden":"true",tabIndex:"-1",href:"#example",children:n(e.span,{className:"icon icon-link"})}),"Example"]}),`
`,n(e.p,{children:["In our example we are executing ",n(e.code,{children:"store.count++"})," and ",n(e.code,{children:"store.delay++"})," together. Wrap the ",n(e.code,{children:"store.delay"})," in ",n(e.code,{children:"delay$()"})," call so that it updates with a one second delay."]})]})}function r(a={}){const{wrapper:e}=a.components||{};return e?n(e,Object.assign({},a,{children:n(s,a)})):s(a)}export{r as default,i as frontmatter,l as head,o as headings};
