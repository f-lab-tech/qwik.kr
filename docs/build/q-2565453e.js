import{i as e,u as s}from"./q-c0df5510.js";const o=[{text:"Reactivity",id:"reactivity",level:1},{text:"Proxy",id:"proxy",level:1},{text:"Counter Example",id:"counter-example",level:2},{text:"Unsubscribe example",id:"unsubscribe-example",level:2},{text:"Deep objects",id:"deep-objects",level:2},{text:"Out-of-order rendering",id:"out-of-order-rendering",level:2},{text:"Invalidating child components",id:"invalidating-child-components",level:2}],i={title:"Overview",meta:[],styles:[],links:[]},l={title:"Overview",fetch:"https://hackmd.io/@mhevery/SyYrShReq"};function t(a){const n=Object.assign({h1:"h1",a:"a",span:"span",p:"p",ol:"ol",li:"li",code:"code",ul:"ul",h2:"h2",pre:"pre"},a.components);return e(s,{children:[e(n.h1,{id:"reactivity",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#reactivity",children:e(n.span,{className:"icon icon-link"})}),"Reactivity"]}),`
`,e(n.p,{children:"Reactivity is a key component of Qwik. Reactivity allows Qwik to track which components are subscribed to which state. This information enables Qwik to invalidate only the relevant component on state change, which minimizes the number of components that need to be re-rendered. Without reactivity, a state change would require re-rendering from the root component, which would force the whole component tree to be eagerly downloaded."}),`
`,e(n.h1,{id:"proxy",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#proxy",children:e(n.span,{className:"icon icon-link"})}),"Proxy"]}),`
`,e(n.p,{children:"Reactivity requires that the framework keeps track of the relationship between the state of the applications and the components. The framework must render the whole application at least once to build the reactivity graph. The build of reactive graph initially happens on the server and is serialized to HTML so that the browser can use the information without being forced to do a single pass through all components to rebuild the graph. (Qwik does not need to do hydration to register events or build up the reactivity graph.)"}),`
`,e(n.p,{children:"Reactivity can be done in a few ways:"}),`
`,e(n.ol,{children:[`
`,e(n.li,{children:["using explicit registration of listeners using ",e(n.code,{children:".subscribe()"})," (for example, RxJS)"]}),`
`,e(n.li,{children:"using implicit registration using a compiler (for example, Svelte)"}),`
`,e(n.li,{children:"using implicit registration using proxies."}),`
`]}),`
`,e(n.p,{children:"Qwik uses proxies for a few reasons:"}),`
`,e(n.ol,{children:[`
`,e(n.li,{children:["using explicit registration such as ",e(n.code,{children:".subscribe()"})," would require the system to serialize all of the subscribed listeners to avoid hydration. Serializing subscribed closures would not be possible as all the subscribe functions would have to be lazy-loaded and asynchronous (too expensive)."]}),`
`,e(n.li,{children:["using the compiler to create graphs implicitly would work, but only for components. Intra component communications would still require ",e(n.code,{children:".subscribe()"})," methods and hence suffer the issues described above."]}),`
`]}),`
`,e(n.p,{children:"Because of the above constraints, Qwik uses proxies to keep track of the reactivity graph."}),`
`,e(n.ul,{children:[`
`,e(n.li,{children:["use ",e(n.code,{children:"useStore()"})," to create a store proxy."]}),`
`,e(n.li,{children:"the proxy notices the reads and creates subscriptions that are serializable."}),`
`,e(n.li,{children:"the proxy notices the writes and uses the subscription information to invalidate the relevant components."}),`
`]}),`
`,e(n.h2,{id:"counter-example",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#counter-example",children:e(n.span,{className:"icon icon-link"})}),"Counter Example"]}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"const"})," Counter ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," store ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"useStore"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"{"})," count",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token operator",children:"++"}),e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.ol,{children:[`
`,e(n.li,{children:["The server performs an initial render of the component. The server rendering includes creating the proxy represented by ",e(n.code,{children:"store"}),"."]}),`
`,e(n.li,{children:["The initial render invokes the OnRender method, which has a reference to the ",e(n.code,{children:"store"}),' proxy. The rendering puts the proxy to "learn" mode. During the build-up of JSX, the proxy observes a read to ',e(n.code,{children:"count"}),' property. Because the proxy is in "learn" mode, it records that the ',e(n.code,{children:"Counter"})," has a subscription on the ",e(n.code,{children:"store.count"}),"."]}),`
`,e(n.li,{children:["The server serializes the state of the application into HTML. This includes the ",e(n.code,{children:"store"})," as well as subscription information which says that ",e(n.code,{children:"Counter"})," is subscribed to ",e(n.code,{children:"store.count"}),"."]}),`
`,e(n.li,{children:["In the browser, the user clicks the button. Because the click event handler closed over ",e(n.code,{children:"store"}),", Qwik restores the store proxy. The proxy contains the application state (the count) and the subscription, which associates the ",e(n.code,{children:"Counter"})," with ",e(n.code,{children:"state.count"}),"."]}),`
`,e(n.li,{children:["The event handler increments the ",e(n.code,{children:"store.count"}),". Because the ",e(n.code,{children:"store"})," is a proxy, it notices the write and uses the subscription information to invalidate the ",e(n.code,{children:"Counter"}),"."]}),`
`,e(n.li,{children:["After ",e(n.code,{children:"requestAnimationFrame"}),", the ",e(n.code,{children:"Counter"})," downloads the rendering function and re-runs the OnRender method."]}),`
`,e(n.li,{children:"During the OnRender, the subscription list is cleared, and a new subscription list is built up by observing what reads the JSX building performs."}),`
`]}),`
`,e(n.h2,{id:"unsubscribe-example",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#unsubscribe-example",children:e(n.span,{className:"icon icon-link"})}),"Unsubscribe example"]}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"const"})," ComplexCounter ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," store ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"useStore"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"{"})," count",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"}),e(n.span,{className:"token punctuation",children:","})," visible",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token boolean",children:"true"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token punctuation",children:"("}),`
    `,e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:e(n.span,{className:"token punctuation",children:"<"})}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),"store",e(n.span,{className:"token punctuation",children:"."}),"visible ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token operator",children:"!"}),"store",e(n.span,{className:"token punctuation",children:"."}),"visible",e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"visible ",e(n.span,{className:"token operator",children:"?"})," ",e(n.span,{className:"token string",children:"'hide'"})," ",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token string",children:"'show'"}),e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token operator",children:"++"}),e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:"increment"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"visible ",e(n.span,{className:"token operator",children:"?"})," ",e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"span"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"span"]}),e(n.span,{className:"token punctuation",children:">"})]})," ",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token keyword",children:"null"}),e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token plain-text",children:`
    `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:e(n.span,{className:"token punctuation",children:"</"})}),e(n.span,{className:"token punctuation",children:">"})]}),`
  `,e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.p,{children:"This example is a more complicated counter."}),`
`,e(n.ul,{children:[`
`,e(n.li,{children:["It contains the ",e(n.code,{children:"increment"})," button, which always increments ",e(n.code,{children:"store.count"}),"."]}),`
`,e(n.li,{children:["It contains a ",e(n.code,{children:"show"}),"/",e(n.code,{children:"hide"})," button which determines if the count is shown."]}),`
`]}),`
`,e(n.ol,{children:[`
`,e(n.li,{children:["On the initial render, the count is visible. Therefore the server creates a subscription that records that ",e(n.code,{children:"ComplexCounter"})," needs to get re-rendered if either ",e(n.code,{children:"store.count"})," or ",e(n.code,{children:"store.visible"})," changes."]}),`
`,e(n.li,{children:["If the user clicks on ",e(n.code,{children:"hide"}),", the ",e(n.code,{children:"ComplexCounter"})," rerenders. The re-rendering clears all of the subscriptions and records new ones. This time the JSX does not read ",e(n.code,{children:"store.count"}),". Therefore, only ",e(n.code,{children:"store.visible"})," gets added to the list of subscriptions."]}),`
`,e(n.li,{children:["User clicking on ",e(n.code,{children:"increment"})," will update ",e(n.code,{children:"store.count"}),", but doing so will not cause the component to re-render. This is correct because the counter is not visible, so re-rendering would be a no-op."]}),`
`,e(n.li,{children:["If the user clicks ",e(n.code,{children:"show"}),", the component will re-render and this time the JSX will read both ",e(n.code,{children:"store.visible"})," as well as ",e(n.code,{children:"store.count"}),". The subscription list is once again updated."]}),`
`,e(n.li,{children:["Now, clicking on ",e(n.code,{children:"increment"})," updates the ",e(n.code,{children:"store.count"}),". Because the count is visible, the ",e(n.code,{children:"ComplexCounter"})," is subscribed to ",e(n.code,{children:"store.count"}),"."]}),`
`]}),`
`,e(n.p,{children:"Notice how the set of subscriptions automatically updates as the component renders different branches of its JSX. The advantage of the proxy is that the subscriptions update automatically as the applications execute, and the system can always compute the smallest set of invalidated components."}),`
`,e(n.h2,{id:"deep-objects",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#deep-objects",children:e(n.span,{className:"icon icon-link"})}),"Deep objects"]}),`
`,e(n.p,{children:["So far, the examples show the store (",e(n.code,{children:"useStore()"}),") was a simple object with primitive values. However, the same behavior works on all properties of the store recursively."]}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"const"})," MyComp ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," store ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"useStore"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"{"}),`
    person`,e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token punctuation",children:"{"})," first",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token keyword",children:"null"}),e(n.span,{className:"token punctuation",children:","})," last",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token keyword",children:"null"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:","}),`
    location`,e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token keyword",children:"null"}),`
  `,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

  store`,e(n.span,{className:"token punctuation",children:"."}),"location ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token punctuation",children:"{"}),"street",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token string",children:"'main st'"}),e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:";"}),`

  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token punctuation",children:"("}),`
    `,e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"div"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"div"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"person",e(n.span,{className:"token punctuation",children:"."}),"last",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token plain-text",children:", "}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"person",e(n.span,{className:"token punctuation",children:"."}),"first",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"div"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"div"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"location",e(n.span,{className:"token punctuation",children:"."}),"street",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"div"]}),e(n.span,{className:"token punctuation",children:">"})]}),`
    `,e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"div"]}),e(n.span,{className:"token punctuation",children:">"})]}),`
  `,e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),`
`]})}),`
`,e(n.p,{children:["In the above examples, Qwik will automatically wrap child objects ",e(n.code,{children:"person"})," and ",e(n.code,{children:"location"})," into a proxy and correctly create subscriptions on all deep properties."]}),`
`,e(n.p,{children:"The wrapping behavior described above has one surprising side-effect. Writing and reading from a proxy auto wraps the object, which means that the identity of the object changes. This should normally not be an issue, but it is something that the developer should keep in mind."}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"const"})," MyComp ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," store ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"useStore"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"{"})," person",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token keyword",children:"null"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," person ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token punctuation",children:"{"})," first",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token string",children:"'John'"}),e(n.span,{className:"token punctuation",children:","})," last",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token string",children:"'Smith'"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:";"}),`
  store`,e(n.span,{className:"token punctuation",children:"."}),"person ",e(n.span,{className:"token operator",children:"="})," person",e(n.span,{className:"token punctuation",children:";"})," ",e(n.span,{className:"token comment",children:"// store.person auto wraps object into proxy"}),`

  `,e(n.span,{className:"token keyword",children:"if"})," ",e(n.span,{className:"token punctuation",children:"("}),"store",e(n.span,{className:"token punctuation",children:"."}),"person ",e(n.span,{className:"token operator",children:"!=="})," person",e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
    `,e(n.span,{className:"token comment",children:"// The consequence of auto wrapping is that the object identity changes."}),`
    `,e(n.span,{className:"token builtin",children:"console"}),e(n.span,{className:"token punctuation",children:"."}),e(n.span,{className:"token function",children:"log"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token string",children:"'store auto-wrapped person into a proxy'"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
  `,e(n.span,{className:"token punctuation",children:"}"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.h2,{id:"out-of-order-rendering",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#out-of-order-rendering",children:e(n.span,{className:"icon icon-link"})}),"Out-of-order rendering"]}),`
`,e(n.p,{children:"Qwik components can render out of order. A component can render without forcing a parent component to render first or a child components to render as a consequence of the component render. This is an important property of Qwik because it allows Qwik applications to only re-render components which have been invalidated due to a state change rather than re-rendering the whole component tree on a state change."}),`
`,e(n.p,{children:["When components render, they need to have access to their props. Parent components create props. The props must be serializable for the component to render independently from the parent. (See ",e(n.a,{href:"https://qwik.builder.io/docs/concepts/resumable#serialization",children:"serialization"})," for an in-depth discussion on what is serializable)"]}),`
`,e(n.h2,{id:"invalidating-child-components",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#invalidating-child-components",children:e(n.span,{className:"icon icon-link"})}),"Invalidating child components"]}),`
`,e(n.p,{children:"When re-rendering a component, the child component's props either stay the same or are updated. A child component only invalidates if it's props change."}),`
`,e(n.pre,{children:e(n.code,{className:"language-tsx",children:[e(n.span,{className:"token keyword",children:"const"})," Child ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),"props",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token punctuation",children:"{"})," count",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token builtin",children:"number"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"span"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:"{"}),"props",e(n.span,{className:"token punctuation",children:"."}),"count",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"span"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

`,e(n.span,{className:"token keyword",children:"const"})," MyApp ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"component$"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," ",e(n.span,{className:"token punctuation",children:"{"}),`
  `,e(n.span,{className:"token keyword",children:"const"})," store ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"useStore"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:"{"})," a",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"}),e(n.span,{className:"token punctuation",children:","})," b",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"}),e(n.span,{className:"token punctuation",children:","})," c",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token number",children:"0"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

  `,e(n.span,{className:"token keyword",children:"return"})," ",e(n.span,{className:"token punctuation",children:"("}),`
    `,e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:e(n.span,{className:"token punctuation",children:"<"})}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," store",e(n.span,{className:"token punctuation",children:"."}),"a",e(n.span,{className:"token operator",children:"++"}),e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:"a++"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," store",e(n.span,{className:"token punctuation",children:"."}),"b",e(n.span,{className:"token operator",children:"++"}),e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:"b++"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),"button"]})," ",e(n.span,{className:"token attr-name",children:"onClick$"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"})," ",e(n.span,{className:"token operator",children:"=>"})," store",e(n.span,{className:"token punctuation",children:"."}),"c",e(n.span,{className:"token operator",children:"++"}),e(n.span,{className:"token punctuation",children:"}"})]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:"c++"}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"</"}),"button"]}),e(n.span,{className:"token punctuation",children:">"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token punctuation",children:"{"}),e(n.span,{className:"token constant",children:"JSON"}),e(n.span,{className:"token punctuation",children:"."}),e(n.span,{className:"token function",children:"stringify"}),e(n.span,{className:"token punctuation",children:"("}),"store",e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token plain-text",children:`

      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),e(n.span,{className:"token class-name",children:"Child"})]})," ",e(n.span,{className:"token attr-name",children:"count"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"a",e(n.span,{className:"token punctuation",children:"}"})]})," ",e(n.span,{className:"token punctuation",children:"/>"})]}),e(n.span,{className:"token plain-text",children:`
      `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:[e(n.span,{className:"token punctuation",children:"<"}),e(n.span,{className:"token class-name",children:"Child"})]})," ",e(n.span,{className:"token attr-name",children:"count"}),e(n.span,{className:"token script language-javascript",children:[e(n.span,{className:"token script-punctuation punctuation",children:"="}),e(n.span,{className:"token punctuation",children:"{"}),"store",e(n.span,{className:"token punctuation",children:"."}),"b",e(n.span,{className:"token punctuation",children:"}"})]})," ",e(n.span,{className:"token punctuation",children:"/>"})]}),e(n.span,{className:"token plain-text",children:`
    `}),e(n.span,{className:"token tag",children:[e(n.span,{className:"token tag",children:e(n.span,{className:"token punctuation",children:"</"})}),e(n.span,{className:"token punctuation",children:">"})]}),`
  `,e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.p,{children:["In the above example, there are two ",e(n.code,{children:"<Child/>"})," components."]}),`
`,e(n.ul,{children:[`
`,e(n.li,{children:["Every time a button is clicked, one of the three counters is incremented. A change of counter state will cause the ",e(n.code,{children:"MyApp"})," component to re-render on each click."]}),`
`,e(n.li,{children:["If ",e(n.code,{children:"store.c"})," has been incremented, none of the child components get re-rendered. (And therefore, their code does not get lazy-loaded)"]}),`
`,e(n.li,{children:["If ",e(n.code,{children:"store.a"})," has been incremented, then only ",e(n.code,{children:"<Child count={store.a}/>"})," will re-render."]}),`
`,e(n.li,{children:["If ",e(n.code,{children:"store.b"})," has been incremented, then only ",e(n.code,{children:"<Child count={store.b}/>"})," will re-render."]}),`
`]}),`
`,e(n.p,{children:"Notice that the child components only re-render when their props change. This is an important property of Qwik applications as it significantly limits the amount of re-rendering the application must do on some state change. While less re-rendering has performance benefits, the real benefit is that large portions of the applications do not get downloaded if they don't need to be re-rendered."})]})}function r(a={}){const{wrapper:n}=a.components||{};return n?e(n,Object.assign({},a,{children:e(t,a)})):t(a)}export{r as default,l as frontmatter,i as head,o as headings};
