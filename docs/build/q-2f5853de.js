import{i as e,u as t}from"./q-c0df5510.js";const i=[{text:"Node Middleware",id:"node-middleware",level:1}],o={title:"Qwik City - Node Middleware",meta:[],styles:[],links:[]},l={title:"Qwik City - Node Middleware"};function s(a){const n=Object.assign({h1:"h1",a:"a",span:"span",p:"p",ul:"ul",li:"li",pre:"pre",code:"code"},a.components);return e(t,{children:[e(n.h1,{id:"node-middleware",children:[e(n.a,{"aria-hidden":"true",tabIndex:"-1",href:"#node-middleware",children:e(n.span,{className:"icon icon-link"})}),"Node Middleware"]}),`
`,e(n.p,{children:"Qwik City Node middleware allows you to connect Qwik City to an Nodejs server which uses the common middleware functionality. Some Node servers include:"}),`
`,e(n.ul,{children:[`
`,e(n.li,{children:e(n.a,{href:"https://expressjs.com/",children:"Express"})}),`
`,e(n.li,{children:e(n.a,{href:"https://www.npmjs.com/package/connect",children:"Connect"})}),`
`,e(n.li,{children:e(n.a,{href:"https://www.npmjs.com/package/polka",children:"Polka"})}),`
`]}),`
`,e(n.p,{children:["Below is an example of using the built-in Node middleware within a user's ",e(n.a,{href:"https://expressjs.com/",children:"Express"})," app. Note that the user can decide the order of the middleware, including handling static assets, and how to handle 404 responses."]}),`
`,e(n.pre,{children:e(n.code,{className:"language-typescript",children:[e(n.span,{className:"token keyword",children:"import"})," ",e(n.span,{className:"token punctuation",children:"{"})," qwikCity ",e(n.span,{className:"token punctuation",children:"}"})," ",e(n.span,{className:"token keyword",children:"from"})," ",e(n.span,{className:"token string",children:"'@builder.io/qwik-city/middleware/node'"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token keyword",children:"import"})," express ",e(n.span,{className:"token keyword",children:"from"})," ",e(n.span,{className:"token string",children:"'express'"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token keyword",children:"import"})," ",e(n.span,{className:"token punctuation",children:"{"})," fileURLToPath ",e(n.span,{className:"token punctuation",children:"}"})," ",e(n.span,{className:"token keyword",children:"from"})," ",e(n.span,{className:"token string",children:"'url'"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token keyword",children:"import"})," ",e(n.span,{className:"token punctuation",children:"{"})," join ",e(n.span,{className:"token punctuation",children:"}"})," ",e(n.span,{className:"token keyword",children:"from"})," ",e(n.span,{className:"token string",children:"'path'"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token keyword",children:"import"})," render ",e(n.span,{className:"token keyword",children:"from"})," ",e(n.span,{className:"token string",children:"'./entry.ssr'"}),e(n.span,{className:"token punctuation",children:";"}),`

`,e(n.span,{className:"token comment",children:"// Directories where the static assets are located"}),`
`,e(n.span,{className:"token keyword",children:"const"})," distDir ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"join"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token function",children:"fileURLToPath"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token keyword",children:"import"}),e(n.span,{className:"token punctuation",children:"."}),"meta",e(n.span,{className:"token punctuation",children:"."}),"url",e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:","})," ",e(n.span,{className:"token string",children:"'..'"}),e(n.span,{className:"token punctuation",children:","})," ",e(n.span,{className:"token string",children:"'..'"}),e(n.span,{className:"token punctuation",children:","})," ",e(n.span,{className:"token string",children:"'dist'"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`,e(n.span,{className:"token keyword",children:"const"})," buildDir ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"join"}),e(n.span,{className:"token punctuation",children:"("}),"distDir",e(n.span,{className:"token punctuation",children:","})," ",e(n.span,{className:"token string",children:"'build'"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

`,e(n.span,{className:"token comment",children:"// Create the Qwik City middleware"}),`
`,e(n.span,{className:"token keyword",children:"const"})," ",e(n.span,{className:"token punctuation",children:"{"})," router",e(n.span,{className:"token punctuation",children:","})," notFound ",e(n.span,{className:"token punctuation",children:"}"})," ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"qwikCity"}),e(n.span,{className:"token punctuation",children:"("}),"render",e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

`,e(n.span,{className:"token comment",children:"// Create the express server"}),`
`,e(n.span,{className:"token keyword",children:"const"})," app ",e(n.span,{className:"token operator",children:"="})," ",e(n.span,{className:"token function",children:"express"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

`,e(n.span,{className:"token comment",children:"// Use Qwik City's page and endpoint router"}),`
app`,e(n.span,{className:"token punctuation",children:"."}),e(n.span,{className:"token function",children:"use"}),e(n.span,{className:"token punctuation",children:"("}),"router",e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

`,e(n.span,{className:"token comment",children:"// Static asset handlers"}),`
app`,e(n.span,{className:"token punctuation",children:"."}),e(n.span,{className:"token function",children:"use"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token template-string",children:[e(n.span,{className:"token template-punctuation string",children:"`"}),e(n.span,{className:"token string",children:"/build"}),e(n.span,{className:"token template-punctuation string",children:"`"})]}),e(n.span,{className:"token punctuation",children:","})," express",e(n.span,{className:"token punctuation",children:"."}),e(n.span,{className:"token function",children:"static"}),e(n.span,{className:"token punctuation",children:"("}),"buildDir",e(n.span,{className:"token punctuation",children:","})," ",e(n.span,{className:"token punctuation",children:"{"})," immutable",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token boolean",children:"true"}),e(n.span,{className:"token punctuation",children:","})," maxAge",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token string",children:"'1y'"}),e(n.span,{className:"token punctuation",children:","})," index",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token boolean",children:"false"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
app`,e(n.span,{className:"token punctuation",children:"."}),e(n.span,{className:"token function",children:"use"}),e(n.span,{className:"token punctuation",children:"("}),"express",e(n.span,{className:"token punctuation",children:"."}),e(n.span,{className:"token function",children:"static"}),e(n.span,{className:"token punctuation",children:"("}),"distDir",e(n.span,{className:"token punctuation",children:","})," ",e(n.span,{className:"token punctuation",children:"{"})," index",e(n.span,{className:"token operator",children:":"})," ",e(n.span,{className:"token boolean",children:"false"})," ",e(n.span,{className:"token punctuation",children:"}"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

`,e(n.span,{className:"token comment",children:"// Use Qwik City's 404 handler"}),`
app`,e(n.span,{className:"token punctuation",children:"."}),e(n.span,{className:"token function",children:"use"}),e(n.span,{className:"token punctuation",children:"("}),"notFound",e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`

`,e(n.span,{className:"token comment",children:"// Start the express server"}),`
app`,e(n.span,{className:"token punctuation",children:"."}),e(n.span,{className:"token function",children:"listen"}),e(n.span,{className:"token punctuation",children:"("}),e(n.span,{className:"token number",children:"3000"}),e(n.span,{className:"token punctuation",children:")"}),e(n.span,{className:"token punctuation",children:";"}),`
`]})}),`
`,e(n.ul,{children:[`
`,e(n.li,{children:e(n.a,{href:"https://github.com/BuilderIO/qwik/tree/main/packages/qwik-city/middleware/node/index.ts",children:"Node Middleware Source"})}),`
`]})]})}function r(a={}){const{wrapper:n}=a.components||{};return n?e(n,Object.assign({},a,{children:e(s,a)})):s(a)}export{r as default,l as frontmatter,o as head,i as headings};
